<div class="inventory-page">
  <a id="scrollView"></a>
  <mat-progress-bar
    class="inventory-page__progress-bar"
    *ngIf="isInProgress && !isFirstLoading"
    mode="query"
  ></mat-progress-bar>

  <div class="container">
    <ng-container *ngIf="isFirstLoading">
      <div fxFlex="row" fxLayoutAlign="center center" class="inventory-page__spinner">
        <mat-spinner></mat-spinner>
      </div>
    </ng-container>

    <ng-container *ngIf="!isFirstLoading">
      <div class="inventory-page__content" fxLayout="row" fxLayoutGap="20px">
        <div fxHide.lt-sm fxFlex.lt-md="30" fxFlex="20">
          <app-inventory-filters [tags]="tags" [filters]="filters" (filterChanged)="onFilterChanged($event)">
          </app-inventory-filters>
        </div>

        <div fxFlex.lt-sm="100" fxFlex.lt-md="70" fxFlex="80">
          <div
            *ngIf="searchResult.items.length"
            fxLayoutAlign.gt-xs="end"
            fxLayoutAlign.xs="space-between"
            class="inventory-page__actions"
          >
            <!--<button fxHide.gt-xs color="primary" mat-raised-button (click)="openFilters()">Filters</button>-->
            <app-sorting-bar
              class="inventory-page__sorting-bar"
              (sortTypeChanged)="onSortTypeChanged($event)"
            ></app-sorting-bar>
          </div>

          <div *ngIf="!searchResult.items.length">
            <h4>0 products</h4>
          </div>

          <div
            class="inventory-page__products"
            [ngClass]="{ 'inventory-page__products--loading': isInProgress }"
            fxLayout="row wrap"
          >
            <div
              fxFlex.xl="25"
              fxFlex.lg="33"
              fxFlex.md="50"
              fxFlex.sm="50"
              fxFlex.xs="100"
              *ngFor="
                let item of searchResult.items
                  | paginate
                    : {
                        itemsPerPage: paginationConfig.itemsPerPage,
                        currentPage: currentPage,
                        totalItems: totalResults
                      }
              "
            >
              <app-product-item
                [item]="item"
                [baseUrl]="'/product'"
                [allowPurchase]="authService.isAuthorized"
                (addedToCart)="onAddedToCart($event)"
              >
              </app-product-item>
            </div>
          </div>

          <div
            fxLayoutAlign="center center"
            class="inventory-page__pagination"
            [ngClass]="{ 'inventory-page__pagination--loading': isInProgress }"
            *ngIf="totalResults > paginationConfig.itemsPerPage"
          >
            <pagination-controls
              (pageChange)="onPageChanged($event)"
              (pageBoundsCorrection)="onPageChanged($event)"
              maxSize="9"
              directionLinks="true"
              responsive="true"
              previousLabel="Previous"
              nextLabel="Next"
            ></pagination-controls>
          </div>
        </div>
      </div>
    </ng-container>
  </div>
</div>
